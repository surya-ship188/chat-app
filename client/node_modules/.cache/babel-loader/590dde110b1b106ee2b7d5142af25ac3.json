{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Elamukhil K/Downloads/simple_chat_app-master/simple_chat_app-master/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/Elamukhil K/Downloads/simple_chat_app-master/simple_chat_app-master/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Elamukhil K/Downloads/simple_chat_app-master/simple_chat_app-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useRef}from'react';import socketIOClient from\"socket.io-client\";import ChatBoxReciever,{ChatBoxSender}from'./ChatBox';import InputText from'./InputText';import UserLogin from'./UserLogin';import{doc,setDoc,collection,serverTimestamp,query,onSnapshot,orderBy}from'firebase/firestore';import db from\"./firebaseConfig/firebaseConfig.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChatContainer(){var socketio=socketIOClient(\"http://localhost:5001\");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chats=_useState2[0],setChats=_useState2[1];var _useState3=useState(localStorage.getItem(\"user\")),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var avatar=localStorage.getItem('avatar');var chatsRef=collection(db,\"Messages\");var messagesEndRef=useRef(null);var scrollToBottom=function scrollToBottom(){var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};useEffect(function(){scrollToBottom();},[chats]);useEffect(function(){socketio.on('chat',function(senderChats){setChats(senderChats);});});useEffect(function(){var q=query(chatsRef,orderBy('createdAt','asc'));var unsub=onSnapshot(q,function(querySnapshot){var fireChats=[];querySnapshot.forEach(function(doc){fireChats.push(doc.data());});setChats([].concat(fireChats));});return function(){unsub();};},[]);function addToFirrebase(chat){var newChat={avatar:avatar,createdAt:serverTimestamp(),user:user,message:chat.message};var chatRef=doc(chatsRef);setDoc(chatRef,newChat).then(function(){return console.log('Chat added succesfully');}).catch(console.log);}function sendChatToSocket(chat){socketio.emit(\"chat\",chat);}function addMessage(chat){var newChat=_objectSpread(_objectSpread({},chat),{},{user:localStorage.getItem(\"user\"),avatar:avatar});addToFirrebase(chat);setChats([].concat(_toConsumableArray(chats),[newChat]));sendChatToSocket([].concat(_toConsumableArray(chats),[newChat]));}function logout(){localStorage.removeItem(\"user\");localStorage.removeItem(\"avatar\");setUser(\"\");}function ChatsList(){return/*#__PURE__*/_jsxs(\"div\",{style:{height:'75vh',overflow:'scroll',overflowX:'hidden'},children:[chats.map(function(chat,index){if(chat.user===user)return/*#__PURE__*/_jsx(ChatBoxSender,{message:chat.message,avatar:chat.avatar,user:chat.user},index);return/*#__PURE__*/_jsx(ChatBoxReciever,{message:chat.message,avatar:chat.avatar,user:chat.user},index);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[user?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:\"row\",justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Username: \",user]}),/*#__PURE__*/_jsxs(\"strong\",{children:[\"Remember to Subscribe to  \",/*#__PURE__*/_jsx(\"a\",{href:\"https://www.youtube.com/channel/UCmoQtgmJ2SHEAPCAR1Q8TBA\",children:\" My Channel\"})]}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return logout();},style:{color:\"blue\",cursor:'pointer'},children:\"Log Out\"})]}),/*#__PURE__*/_jsx(ChatsList,{}),/*#__PURE__*/_jsx(InputText,{addMessage:addMessage})]}):/*#__PURE__*/_jsx(UserLogin,{setUser:setUser}),/*#__PURE__*/_jsx(\"div\",{style:{margin:10,display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"small\",{style:{backgroundColor:'lightblue',padding:5,borderRadius:5},children:[\"Interested in some 1 on 1 Coding Tutorials and Mentorship. Lets chat on Discord: \",/*#__PURE__*/_jsx(\"strong\",{children:\" kutlo_sek#5370 \"})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","socketIOClient","ChatBoxReciever","ChatBoxSender","InputText","UserLogin","doc","setDoc","collection","serverTimestamp","query","onSnapshot","orderBy","db","ChatContainer","socketio","chats","setChats","localStorage","getItem","user","setUser","avatar","chatsRef","messagesEndRef","scrollToBottom","current","scrollIntoView","behavior","on","senderChats","q","unsub","querySnapshot","fireChats","forEach","push","data","addToFirrebase","chat","newChat","createdAt","message","chatRef","then","console","log","catch","sendChatToSocket","emit","addMessage","logout","removeItem","ChatsList","height","overflow","overflowX","map","index","display","flexDirection","justifyContent","color","cursor","margin","backgroundColor","padding","borderRadius"],"sources":["C:/Users/Elamukhil K/Downloads/simple_chat_app-master/simple_chat_app-master/client/src/components/ChatContainer.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react'\nimport socketIOClient from \"socket.io-client\";\nimport ChatBoxReciever, { ChatBoxSender } from './ChatBox';\nimport InputText from './InputText';\nimport UserLogin from './UserLogin';\nimport {\n    doc,\n    setDoc,\n    collection,\n    serverTimestamp,\n    query,\n    onSnapshot,\n    orderBy,\n  \n  } from 'firebase/firestore';\n  import db from \"./firebaseConfig/firebaseConfig.js\"\n\n\nexport default function ChatContainer() {\n  \n    let socketio  = socketIOClient(\"http://localhost:5001\")\n    const [chats , setChats] = useState([])\n    const [user, setUser] = useState(localStorage.getItem(\"user\"))\n    const avatar = localStorage.getItem('avatar')\n    const chatsRef = collection(db , \"Messages\")\n    const messagesEndRef = useRef(null)\n    const scrollToBottom = () => {\n      messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n    }    \n\n    useEffect(() => {\n      scrollToBottom()\n    }, [chats])\n\n    useEffect(()=> {\n        socketio.on('chat', senderChats => {\n            setChats(senderChats)\n        })\n    })\n\n\n    useEffect(()=>{\n\n        const q = query(chatsRef , orderBy('createdAt' , 'asc'))\n      \n        const unsub = onSnapshot(q, (querySnapshot) =>{\n          const fireChats =[]\n          querySnapshot.forEach(doc => {\n            fireChats.push(doc.data())\n          });\n         setChats([...fireChats])\n        })\n        return ()=> {\n          unsub()\n        }\n      \n      },[])\n\n     function addToFirrebase(chat){\n        const newChat = {\n            avatar,\n            createdAt: serverTimestamp(),\n            user,\n            message: chat.message\n        }\n\n        const chatRef = doc(chatsRef)\n        setDoc(chatRef , newChat)\n        .then(()=> console.log('Chat added succesfully'))\n        .catch(console.log)\n     } \n   \n\n    function sendChatToSocket(chat){\n        socketio.emit(\"chat\" , chat)\n    }\n\n    function addMessage(chat){\n        const newChat = {...chat , user:localStorage.getItem(\"user\") , avatar}\n        addToFirrebase(chat)\n        setChats([...chats , newChat])\n        sendChatToSocket([...chats , newChat])\n    }\n\n    function logout(){\n        localStorage.removeItem(\"user\")\n        localStorage.removeItem(\"avatar\")\n        setUser(\"\")   \n    }\n\n    function ChatsList(){\n        return( <div style={{ height:'75vh' , overflow:'scroll' , overflowX:'hidden' }}>\n              {\n                 chats.map((chat, index) => {\n                  if(chat.user === user) return <ChatBoxSender  key={index} message={chat.message} avatar={chat.avatar} user={chat.user} />\n                  return <ChatBoxReciever key={index} message={chat.message} avatar={chat.avatar} user={chat.user} />\n              })\n              }\n               <div ref={messagesEndRef} />\n        </div>)\n       \n    }\n\n  return (\n    <div>\n        {\n        user ?\n         <div>\n        \n         <div style={{display:'flex', flexDirection:\"row\", justifyContent: 'space-between'}} >\n          <h4>Username: {user}</h4>\n          <strong>Remember to Subscribe to  <a href='https://www.youtube.com/channel/UCmoQtgmJ2SHEAPCAR1Q8TBA'> My Channel</a></strong>\n          <p onClick={()=> logout()} style={{color:\"blue\", cursor:'pointer'}} >Log Out</p>\n           </div>\n            <ChatsList\n             />\n            \n            <InputText addMessage={addMessage} />\n        </div>\n        : <UserLogin setUser={setUser} />\n        }\n\n    <div style={{margin:10 , display:'flex', justifyContent:'center'}} >\n    <small style={{backgroundColor:'lightblue' , padding:5 , borderRadius:5}} >Interested in some 1 on 1 Coding Tutorials and Mentorship. Lets chat on Discord: <strong> kutlo_sek#5370 </strong></small>\n        \n    </div>\n     \n    </div>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}